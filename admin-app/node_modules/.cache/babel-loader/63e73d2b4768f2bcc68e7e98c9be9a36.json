{"ast":null,"code":"var _jsxFileName = \"/home/yazkh/Documents/WebDevelopment/ZingVibesWeb/admin-app/src/components/container/category/Category.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { Col, Container, Row } from 'react-bootstrap';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getAllCategory, addCategory, updateCategories, deleteCategories as deleteCategoriesAction } from '../../../actions/actions';\nimport NewModal from '../../UI/modal/modal';\nimport Layout from '../../layouts/header.layout';\nimport CheckboxTree from 'react-checkbox-tree';\nimport 'react-checkbox-tree/lib/react-checkbox-tree.css';\nimport { IoCheckbox, IoArrowDown, IoArrowForward } from 'react-icons/io5';\nimport { IoIosCheckboxOutline, IoIosAdd, IoIosCloudUpload, IoIosTrash } from 'react-icons/io';\nimport UpdateCategoriesModal from './CategoryComponents.js/UpdateCategoryModal';\nimport AddCategoryModal from './CategoryComponents.js/AddCategoryModal';\nimport './style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Category = props => {\n  _s();\n\n  const [categoryName, setCategoryName] = useState('');\n  const [parentCategoryId, setParentCategoryId] = useState('');\n  const [categoryImage, setCategoryImage] = useState('');\n  const [updateCategoryModal, setUpdateCategoryModal] = useState(false);\n  const [show, setShow] = useState(false);\n  const [checked, setChecked] = useState([]);\n  const [expanded, setExpanded] = useState([]);\n  const [checkedArray, setCheckedArray] = useState([]);\n  const [expandedArray, setExpandedArray] = useState([]);\n  const [deleteCategoryModal, setDeleteCategoryModal] = useState(false);\n  const category = useSelector(state => state.category);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (!category.loading) setShow(false);\n  }, [category.loading]);\n\n  const handleClose = () => {\n    const form = new FormData();\n\n    if (categoryName === '') {\n      alert('Category name is required');\n      return;\n    }\n\n    form.append('name', categoryName);\n    form.append('parentId', parentCategoryId);\n    form.append('categoryPicture', categoryImage);\n    dispatch(addCategory(form)); // window.location.reload(false)\n\n    setCategoryName('');\n    setParentCategoryId('');\n    setShow(false);\n  };\n\n  const handleShow = () => setShow(true);\n\n  const renderCategories = categories => {\n    let myCategories = [];\n\n    for (let category of categories) {\n      myCategories.push({\n        label: category.name,\n        value: category._id,\n        children: category.children.length > 0 && renderCategories(category.children)\n      });\n    }\n\n    return myCategories;\n  };\n\n  const createCategoryList = (categories, options = []) => {\n    for (let category of categories) {\n      options.push({\n        value: category._id,\n        name: category.name,\n        parentId: category.parentId,\n        type: category.type\n      });\n\n      if (category.children.length > 0) {\n        createCategoryList(category.children, options);\n      }\n    }\n\n    return options;\n  };\n\n  const handleCategoryImage = e => {\n    setCategoryImage(e.target.files[0]);\n  };\n\n  const updateCategory = () => {\n    updateCheckedExpandedCategories();\n    setUpdateCategoryModal(true);\n  };\n\n  const updateCheckedExpandedCategories = () => {\n    const categories = createCategoryList(category.categories);\n    const checkedArray = [];\n    const expandedArray = [];\n    checked.length > 0 && checked.forEach((categoryId, index) => {\n      const category = categories.find((category, _index) => categoryId === category.value); //there is maybe a change a catgeory won't match, so just for safety we will have to do this\n\n      category && checkedArray.push(category);\n    });\n    expanded.length > 0 && expanded.forEach((categoryId, index) => {\n      const category = categories.find((category, _index) => categoryId === category.value); //there is maybe a change a catgeory won't match, so just for safety we will have to do this\n\n      category && expandedArray.push(category);\n    }); //these two will help to modify the inputs in edit category\n\n    setCheckedArray(checkedArray);\n    setExpandedArray(expandedArray);\n  };\n\n  const handleCategoryInput = (key, value, index, type) => {\n    if (type === 'checked') {\n      const updatedCheckedArray = checkedArray.map((item, _index) => index === _index ? { ...item,\n        [key]: value\n      } : item);\n      setCheckedArray(updatedCheckedArray);\n    } else if (type === 'expanded') {\n      const updatedExpandedArray = expandedArray.map((item, _index) => index === _index ? { ...item,\n        [key]: value\n      } : item);\n      setExpandedArray(updatedExpandedArray);\n    }\n  };\n\n  {\n    /* Edit Categories */\n  }\n\n  const updateCategoriesForm = () => {\n    const form = new FormData();\n    expandedArray.forEach((item, index) => {\n      form.append('_id', item.value);\n      form.append('name', item.name);\n      form.append('parentId', item.parentId ? item.parentId : '');\n      form.append('type', item.type);\n    });\n    checkedArray.forEach((item, index) => {\n      form.append('_id', item.value);\n      form.append('name', item.name);\n      form.append('parentId', item.parentId ? item.parentId : '');\n      form.append('type', item.type);\n    });\n    dispatch(updateCategories(form)).then(result => {\n      if (result) {\n        dispatch(getAllCategory());\n      }\n    });\n    setUpdateCategoryModal(false);\n  };\n\n  const deleteCategory = () => {\n    updateCheckedExpandedCategories();\n    setDeleteCategoryModal(true);\n  };\n\n  const deleteCategories = () => {\n    //get expandedCategory id\n    const expandedByIdArray = expandedArray.map((item, index) => ({\n      _id: item.value\n    })); //get checkedCategory id\n\n    const checkedByIdArray = checkedArray.map((item, index) => ({\n      _id: item.value\n    })); //merge the checked and expanded arrays by id\n\n    const arrayByIds = expandedByIdArray.concat(checkedByIdArray);\n\n    if (checkedArray.length > 0) {\n      dispatch(deleteCategoriesAction(checkedByIdArray)).then(result => {\n        if (result) {\n          dispatch(getAllCategory());\n          setDeleteCategoryModal(false);\n        }\n      });\n    }\n\n    setDeleteCategoryModal(false);\n  };\n\n  const renderDeleteCategoryModal = () => {\n    // console.log('delete', checkedArray)\n    return /*#__PURE__*/_jsxDEV(NewModal, {\n      modalTitle: \"Confirm\",\n      show: deleteCategoryModal,\n      handleClose: () => setDeleteCategoryModal(false),\n      buttons: [{\n        label: 'No',\n        color: 'primary',\n        onClick: () => {\n          alert('no');\n        }\n      }, {\n        label: 'Yes',\n        color: 'danger',\n        onClick: deleteCategories\n      }],\n      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n        children: \"Expanded\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), expandedArray.map((item, index) => /*#__PURE__*/_jsxDEV(\"span\", {\n        children: item.name\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"h5\", {\n        children: \"Checked\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this), checkedArray.map((item, index) => /*#__PURE__*/_jsxDEV(\"span\", {\n        children: item.name\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this);\n  };\n\n  const categoryList = createCategoryList(category.categories);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Layout, {\n      sidebar: true,\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            md: 12,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"Category\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"action-btn-container\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Actions: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleShow,\n                  children: [/*#__PURE__*/_jsxDEV(IoIosAdd, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 256,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \" Add\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 257,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 255,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: deleteCategory,\n                  children: [/*#__PURE__*/_jsxDEV(IoIosTrash, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 260,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Delete\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 261,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: updateCategory,\n                  children: [/*#__PURE__*/_jsxDEV(IoIosCloudUpload, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 264,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \" Edit\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 265,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 263,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            md: 12,\n            children: /*#__PURE__*/_jsxDEV(CheckboxTree, {\n              nodes: renderCategories(category.categories),\n              checked: checked,\n              expanded: expanded,\n              onCheck: checked => setChecked(checked),\n              onExpand: expanded => setExpanded(expanded),\n              icons: {\n                check: /*#__PURE__*/_jsxDEV(IoCheckbox, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 26\n                }, this),\n                uncheck: /*#__PURE__*/_jsxDEV(IoIosCheckboxOutline, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 28\n                }, this),\n                halfCheck: /*#__PURE__*/_jsxDEV(IoIosCheckboxOutline, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 30\n                }, this),\n                expandClose: /*#__PURE__*/_jsxDEV(IoArrowForward, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 32\n                }, this),\n                expandOpen: /*#__PURE__*/_jsxDEV(IoArrowDown, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 31\n                }, this)\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 273,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AddCategoryModal, {\n        show: show,\n        handleClose: () => setShow(false),\n        onSubmit: handleClose,\n        modalTitle: 'Add New Category',\n        categoryName: categoryName,\n        setCategoryName: setCategoryName,\n        parentCategoryId: parentCategoryId,\n        setParentCategoryId: setParentCategoryId,\n        categoryList: categoryList,\n        handleCategoryImage: handleCategoryImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(UpdateCategoriesModal, {\n        show: updateCategoryModal,\n        handleClose: updateCategoriesForm,\n        modalTitle: 'Update Categories',\n        size: \"lg\",\n        expandedArray: expandedArray,\n        checkedArray: checkedArray,\n        handleCategoryInput: handleCategoryInput,\n        categoryList: categoryList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this), renderDeleteCategoryModal()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 246,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Category, \"DkMg3+V5QZmAK5gTcWJIYSJY3aI=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = Category;\nexport default Category;\n\nvar _c;\n\n$RefreshReg$(_c, \"Category\");","map":{"version":3,"sources":["/home/yazkh/Documents/WebDevelopment/ZingVibesWeb/admin-app/src/components/container/category/Category.js"],"names":["React","useState","useEffect","Col","Container","Row","useDispatch","useSelector","getAllCategory","addCategory","updateCategories","deleteCategories","deleteCategoriesAction","NewModal","Layout","CheckboxTree","IoCheckbox","IoArrowDown","IoArrowForward","IoIosCheckboxOutline","IoIosAdd","IoIosCloudUpload","IoIosTrash","UpdateCategoriesModal","AddCategoryModal","Category","props","categoryName","setCategoryName","parentCategoryId","setParentCategoryId","categoryImage","setCategoryImage","updateCategoryModal","setUpdateCategoryModal","show","setShow","checked","setChecked","expanded","setExpanded","checkedArray","setCheckedArray","expandedArray","setExpandedArray","deleteCategoryModal","setDeleteCategoryModal","category","state","dispatch","loading","handleClose","form","FormData","alert","append","handleShow","renderCategories","categories","myCategories","push","label","name","value","_id","children","length","createCategoryList","options","parentId","type","handleCategoryImage","e","target","files","updateCategory","updateCheckedExpandedCategories","forEach","categoryId","index","find","_index","handleCategoryInput","key","updatedCheckedArray","map","item","updatedExpandedArray","updateCategoriesForm","then","result","deleteCategory","expandedByIdArray","checkedByIdArray","arrayByIds","concat","renderDeleteCategoryModal","color","onClick","categoryList","display","justifyContent","check","uncheck","halfCheck","expandClose","expandOpen"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Col, Container, Row } from 'react-bootstrap'\n\nimport { useDispatch, useSelector } from 'react-redux'\nimport {\n  getAllCategory,\n  addCategory,\n  updateCategories,\n  deleteCategories as deleteCategoriesAction,\n} from '../../../actions/actions'\nimport NewModal from '../../UI/modal/modal'\nimport Layout from '../../layouts/header.layout'\nimport CheckboxTree from 'react-checkbox-tree'\nimport 'react-checkbox-tree/lib/react-checkbox-tree.css'\nimport { IoCheckbox, IoArrowDown, IoArrowForward } from 'react-icons/io5'\n\nimport {\n  IoIosCheckboxOutline,\n  IoIosAdd,\n  IoIosCloudUpload,\n  IoIosTrash,\n} from 'react-icons/io'\nimport UpdateCategoriesModal from './CategoryComponents.js/UpdateCategoryModal'\nimport AddCategoryModal from './CategoryComponents.js/AddCategoryModal'\nimport './style.css'\n\nconst Category = (props) => {\n  const [categoryName, setCategoryName] = useState('')\n  const [parentCategoryId, setParentCategoryId] = useState('')\n  const [categoryImage, setCategoryImage] = useState('')\n  const [updateCategoryModal, setUpdateCategoryModal] = useState(false)\n  const [show, setShow] = useState(false)\n\n  const [checked, setChecked] = useState([])\n  const [expanded, setExpanded] = useState([])\n\n  const [checkedArray, setCheckedArray] = useState([])\n  const [expandedArray, setExpandedArray] = useState([])\n\n  const [deleteCategoryModal, setDeleteCategoryModal] = useState(false)\n\n  const category = useSelector((state) => state.category)\n  const dispatch = useDispatch()\n\n  useEffect(() => {\n    if (!category.loading) setShow(false)\n  }, [category.loading])\n\n  const handleClose = () => {\n    const form = new FormData()\n\n    if (categoryName === '') {\n      alert('Category name is required')\n      return\n    }\n\n    form.append('name', categoryName)\n    form.append('parentId', parentCategoryId)\n    form.append('categoryPicture', categoryImage)\n    dispatch(addCategory(form))\n    // window.location.reload(false)\n    setCategoryName('')\n    setParentCategoryId('')\n    setShow(false)\n  }\n  const handleShow = () => setShow(true)\n\n  const renderCategories = (categories) => {\n    let myCategories = []\n    for (let category of categories) {\n      myCategories.push({\n        label: category.name,\n        value: category._id,\n        children:\n          category.children.length > 0 && renderCategories(category.children),\n      })\n    }\n    return myCategories\n  }\n\n  const createCategoryList = (categories, options = []) => {\n    for (let category of categories) {\n      options.push({\n        value: category._id,\n        name: category.name,\n        parentId: category.parentId,\n        type: category.type,\n      })\n      if (category.children.length > 0) {\n        createCategoryList(category.children, options)\n      }\n    }\n\n    return options\n  }\n\n  const handleCategoryImage = (e) => {\n    setCategoryImage(e.target.files[0])\n  }\n\n  const updateCategory = () => {\n    updateCheckedExpandedCategories()\n    setUpdateCategoryModal(true)\n  }\n\n  const updateCheckedExpandedCategories = () => {\n    const categories = createCategoryList(category.categories)\n    const checkedArray = []\n    const expandedArray = []\n    checked.length > 0 &&\n      checked.forEach((categoryId, index) => {\n        const category = categories.find(\n          (category, _index) => categoryId === category.value\n        )\n\n        //there is maybe a change a catgeory won't match, so just for safety we will have to do this\n        category && checkedArray.push(category)\n      })\n\n    expanded.length > 0 &&\n      expanded.forEach((categoryId, index) => {\n        const category = categories.find(\n          (category, _index) => categoryId === category.value\n        )\n\n        //there is maybe a change a catgeory won't match, so just for safety we will have to do this\n        category && expandedArray.push(category)\n      })\n\n    //these two will help to modify the inputs in edit category\n    setCheckedArray(checkedArray)\n    setExpandedArray(expandedArray)\n  }\n\n  const handleCategoryInput = (key, value, index, type) => {\n    if (type === 'checked') {\n      const updatedCheckedArray = checkedArray.map((item, _index) =>\n        index === _index ? { ...item, [key]: value } : item\n      )\n      setCheckedArray(updatedCheckedArray)\n    } else if (type === 'expanded') {\n      const updatedExpandedArray = expandedArray.map((item, _index) =>\n        index === _index ? { ...item, [key]: value } : item\n      )\n      setExpandedArray(updatedExpandedArray)\n    }\n  }\n  {\n    /* Edit Categories */\n  }\n\n  const updateCategoriesForm = () => {\n    const form = new FormData()\n    expandedArray.forEach((item, index) => {\n      form.append('_id', item.value)\n      form.append('name', item.name)\n      form.append('parentId', item.parentId ? item.parentId : '')\n      form.append('type', item.type)\n    })\n\n    checkedArray.forEach((item, index) => {\n      form.append('_id', item.value)\n      form.append('name', item.name)\n      form.append('parentId', item.parentId ? item.parentId : '')\n      form.append('type', item.type)\n    })\n\n    dispatch(updateCategories(form)).then((result) => {\n      if (result) {\n        dispatch(getAllCategory())\n      }\n    })\n\n    setUpdateCategoryModal(false)\n  }\n\n  const deleteCategory = () => {\n    updateCheckedExpandedCategories()\n    setDeleteCategoryModal(true)\n  }\n\n  const deleteCategories = () => {\n    //get expandedCategory id\n    const expandedByIdArray = expandedArray.map((item, index) => ({\n      _id: item.value,\n    }))\n\n    //get checkedCategory id\n    const checkedByIdArray = checkedArray.map((item, index) => ({\n      _id: item.value,\n    }))\n\n    //merge the checked and expanded arrays by id\n    const arrayByIds = expandedByIdArray.concat(checkedByIdArray)\n\n    if (checkedArray.length > 0) {\n      dispatch(deleteCategoriesAction(checkedByIdArray)).then((result) => {\n        if (result) {\n          dispatch(getAllCategory())\n          setDeleteCategoryModal(false)\n        }\n      })\n    }\n\n    setDeleteCategoryModal(false)\n  }\n\n  const renderDeleteCategoryModal = () => {\n    // console.log('delete', checkedArray)\n\n    return (\n      <NewModal\n        modalTitle=\"Confirm\"\n        show={deleteCategoryModal}\n        handleClose={() => setDeleteCategoryModal(false)}\n        buttons={[\n          {\n            label: 'No',\n            color: 'primary',\n            onClick: () => {\n              alert('no')\n            },\n          },\n          {\n            label: 'Yes',\n            color: 'danger',\n            onClick: deleteCategories,\n          },\n        ]}\n      >\n        <h5>Expanded</h5>\n        {expandedArray.map((item, index) => (\n          <span key={index}>{item.name}</span>\n        ))}\n        <h5>Checked</h5>\n        {checkedArray.map((item, index) => (\n          <span key={index}>{item.name}</span>\n        ))}\n      </NewModal>\n    )\n  }\n\n  const categoryList = createCategoryList(category.categories)\n\n  return (\n    <div>\n      <Layout sidebar>\n        <Container>\n          <Row>\n            <Col md={12}>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <h3>Category</h3>\n                <div className=\"action-btn-container\">\n                  <span>Actions: </span>\n                  <button onClick={handleShow}>\n                    <IoIosAdd />\n                    <span> Add</span>\n                  </button>\n                  <button onClick={deleteCategory}>\n                    <IoIosTrash />\n                    <span>Delete</span>\n                  </button>\n                  <button onClick={updateCategory}>\n                    <IoIosCloudUpload />\n                    <span> Edit</span>\n                  </button>\n                </div>\n              </div>\n            </Col>\n          </Row>\n          <Row>\n            <Col md={12}>\n              <CheckboxTree\n                nodes={renderCategories(category.categories)}\n                checked={checked}\n                expanded={expanded}\n                onCheck={(checked) => setChecked(checked)}\n                onExpand={(expanded) => setExpanded(expanded)}\n                icons={{\n                  check: <IoCheckbox />,\n                  uncheck: <IoIosCheckboxOutline />,\n                  halfCheck: <IoIosCheckboxOutline />,\n                  expandClose: <IoArrowForward />,\n                  expandOpen: <IoArrowDown />,\n                }}\n              />\n            </Col>\n          </Row>\n        </Container>\n\n        <AddCategoryModal\n          show={show}\n          handleClose={() => setShow(false)}\n          onSubmit={handleClose}\n          modalTitle={'Add New Category'}\n          categoryName={categoryName}\n          setCategoryName={setCategoryName}\n          parentCategoryId={parentCategoryId}\n          setParentCategoryId={setParentCategoryId}\n          categoryList={categoryList}\n          handleCategoryImage={handleCategoryImage}\n        />\n\n        <UpdateCategoriesModal\n          show={updateCategoryModal}\n          handleClose={updateCategoriesForm}\n          modalTitle={'Update Categories'}\n          size=\"lg\"\n          expandedArray={expandedArray}\n          checkedArray={checkedArray}\n          handleCategoryInput={handleCategoryInput}\n          categoryList={categoryList}\n        />\n        {renderDeleteCategoryModal()}\n      </Layout>\n    </div>\n  )\n}\n\nexport default Category\n"]},"metadata":{},"sourceType":"module"}